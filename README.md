OAuth node
==========

#### Authorization code

When using authorization code you need redirect your user to oauth's authorization page with some params. In this page the user will authorizate your application to access user's data. See bellow a example url.


```http
https://auth.clairtonluz.com.br/auth
  ?response_type=code
  &client_id=my_client_id
  &redirect_uri=https://myapp.com/autorization
  &state=1234zyx
  &code_challenge=AMvvsDbkWG96ZYUKLvRPqWP45W2rWFmC8wT_acRccqs
  &code_challenge_method=S256
  &scope=openid
```
* **response_type=code** (Required) – indicates that your server expects to receive an authorization code

* **client_id=my_client_id** (Required) – The client ID you received when you first created the application

* **redirect_uri=https://myapp.com/autorization** (Optional if the client has only one registered redirect uri) – Indicates the URL to return the user to after authorization is complete, such as https://myapp.com/autorization

* **state=1234zyx** – A random string generated by your application, which you’ll verify later. This is used to check if the response of authorization code was called by your application.

* **code_challenge=XXXXXXXXX** – The code challenge generated. I will explain how generage this code bellow, but if you wanna test now, you can generage this code through this site: https://tonyxu-io.github.io/pkce-generator/.

* **code_challenge_method=S256** – either plain or S256, depending on whether the challenge is the plain verifier string or the SHA256 hash of the string. If this parameter is omitted, the server will assume plain.

When you redirect user to uri created above, the user will authorize the access e the server will redirect the user to your **redirect_uri** with the **code** and **stage**, then your application will check **stage** to verify if this state is the same **state** created by application. If yes, the application will change the **code** by **access_code** using the process bellow:

#### Code Exchange

```http
POST /token HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Host: localhost
Content-Length: 327

code=OaMoM527Flxtzeqw98Qh8mZv2l9i5n33gbqTgp2z478
&grant_type=authorization_code
&redirect_uri=http://example.local:3000/autorization
&client_id=web_application
&code_verifier=OXqRZcgZ25zKtqM1AjlZoTrRavh126kFCPJakslJSogMnbhXE9Ab0DS85ViphjTvqEOP5jM4nzcsgJOsYXxaJIzwbhFEzmxYgO13vGMbXsJkvxWopzhCqNtDRMkBTMnp
&client_secret=bar
```
